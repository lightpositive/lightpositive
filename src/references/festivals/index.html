---
layout: posts_festival
---

<section class="posts__content">
  {% set postslist = collections.festival %} {% for festival in postslist |
  reverse %} {% if festival.url != page.url %}
  <figure class="posts__card">
    <a href="{{ festival.url | url }}" class="posts__link">
      <img
        src="{{festival.data.coverImage}}"
        class="posts__image-cover"
        alt="{{festival.data.title}} cover image"
      />
      <figcaption class="posts__image-caption">
        {{ festival.data.title }}
      </figcaption>
    </a>
  </figure>
  {% endif %} {% endfor %}
</section>
<script>
  let lowRes = "w_400";
  let allImage = document.querySelectorAll(".posts__image-cover");

  // create
  let preUrl = "https://res.cloudinary.com/lightpositive/";
  let allImageSrc = [];
  let allImageSrcMid = [];
  let allImageSrcHi = [];
  let currentIndex = { i: 0 };
  allImage.forEach((element) => {
    let src = element.getAttribute("src");
    // let matched = src.match(/upload\/(?:v\d+\/)?([^\.]+)/);
    let matched = src.match(/lightpositive\/(?:v\d+\/)([^]+)\.(?!.*\.)/);
    let srcNew = preUrl.concat(lowRes, "/", matched[1]);
    allImageSrc = [...allImageSrc, srcNew];
    element.setAttribute("src", srcNew);
  });
</script>
