---
layout: posts_festival
---

<section class="posts__content">
  {% set postslist = collections.festival %} {% for festival in postslist |
  reverse %} {% if festival.url != page.url %}
  <figure class="posts__card">
    <a href="{{ festival.url | url }}" class="posts__link">
      <img
        src="{{festival.data.coverImage}}"
        class="posts__image-cover"
        alt="{{festival.data.title}} cover image"
      />
      <figcaption class="posts__image-caption">
        {{ festival.data.title }}
      </figcaption>
    </a>
  </figure>
  {% endif %} {% endfor %}
</section>
<script>
  let lowRes = "w_256";
  const coverImage = document
    .getElementsByClassName("posts__image-cover")
    .item(0);
  let preUrl = "https://res.cloudinary.com/lightpositive/image/upload/";
  let src = coverImage.getAttribute("src");
  // let matched = src.match(/upload\/(?:v\d+\/)?([^\.]+)/);
  let matched = src.match(/upload\/(?:v\d+\/)([^]+)\.(?!.*\.)/);
  let srcNew = preUrl.concat(lowRes, "/", matched[1]);
  coverImage.setAttribute("src", srcNew);
  console.log(coverImage);
</script>
